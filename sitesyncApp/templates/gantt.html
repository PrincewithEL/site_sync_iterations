<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Site Sync - {{ type }} Module - Gantt Chart Page</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    {% load static %}
    {% load custom_filters %}
                {% load tz %} 
    <!-- Bootstrap 3.3.2 -->
    <link href="{% static 'dashboard/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />   
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">   
    <!-- FontAwesome 4.3.0 -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" /> 
    <!-- Theme style -->
    <link href="{% static 'dashboard/dist/css/sitesync.css' %}" rel="stylesheet" type="text/css" />
    <!-- Skins -->
    <link href="{% static 'dashboard/dist/css/skins/skin-black.min.css' %}" rel="stylesheet" type="text/css" />
    <!-- bootstrap wysihtml5 - text editor -->
    <link href="{% static 'dashboard/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css' %}" rel="stylesheet" type="text/css" />
  </head>
      <style>
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        .dropdown:hover .dropbtn {
            background-color: orange;
        }
        
        .dropbtn {
            background-color: white;
            color: black;
            padding: 5px;
            font-size: 16px;
            border: none;
            cursor: pointer;
            width: 200px;
            text-align: left;
        }
        .custom-checkbox {
    display: block !important;
    margin: auto;
    width: 16px;
    height: 16px;
}
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            // Load the Google Charts library
            google.charts.load('current', {'packages':['gantt']});
            google.charts.setOnLoadCallback(fetchDataAndDrawChart);
            var projectId = '{{ project.project_id }}';  // Ensure `project` is contextually available
                
            function fetchDataAndDrawChart() {
                $.ajax({
                    url: '/projects/' + projectId + '/tasks1/', // URL to fetch data from
                    method: 'GET',              // HTTP method
                    dataType: 'json',           // Expecting JSON response
                    success: function(data) {
                        drawChart(data);   // Call your chart drawing function
                    },
                    error: function(jqXHR, textStatus, errorThrown) {
                        // Handle errors
                        console.error('Error fetching data:', textStatus, errorThrown);
                    }
                });
            }

            function drawChart(data) {
                // Create a DataTable and add columns
                var chartData = new google.visualization.DataTable();
                chartData.addColumn('string', 'Task ID');
                chartData.addColumn('string', 'Task Name');
                chartData.addColumn('string', 'Assigned To');
                chartData.addColumn('date', 'Start Date');
                chartData.addColumn('date', 'End Date');
                chartData.addColumn('number', 'Duration');
                chartData.addColumn('number', 'Percent Complete');
                chartData.addColumn('string', 'Dependencies');

                // Populate DataTable with data from AJAX response
                data.tasks.forEach(task => {
                    chartData.addRow([
                        task[0],  // Task ID
                        task[1],  // Task Name
                        task[2],  // Resource
                        new Date(task[3]),  // Start Date
                        new Date(task[4]),  // End Date
                        task[5],  // Duration
                        task[6],  // Percent Complete
                        task[7]   // Dependencies
                    ]);
                });

                // Instantiate and draw the chart
                var chart = new google.visualization.Gantt(document.getElementById('chart_div'));
                chart.draw(chartData, {
                    height: 300,
                    gantt: {
                        trackHeight: 30
                    }
                });
            }
        });
    </script>
  <body class="skin-black">
    <div class="wrapper">
      
      <header class="main-header">
        <!-- Logo -->
        <a href="{% url 'client' %}" title="Site Sync" class="logo" style="color: orange;"><img src="{% static 'dashboard/dist/img/site_sync_logo.png' %}" style="width: 120px; position: relative; top: -8px;"></a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" role="navigation">
          <!-- Sidebar toggle button-->
          <a href="#" title="Hide the Site Sync Assistant" class="sidebar-toggle" data-toggle="offcanvas" role="button">
            <span class="sr-only">Toggle navigation</span>
          </a>
          <div class="navbar-custom-menu">
              <ul class="nav navbar-nav">
  {% include 'notifications.html' %}
                <!-- User Account: style can be found in dropdown.less -->
              <li class="dropdown user user-menu" title="My Profile">
                <a href="{% url 'profile' %}" class="dropdown-toggle">
                  <img src="{{ MEDIA_URL }}{{ auth_user.profile.profile_picture }}" class="user-image" alt="User Image"/>
                  <span class="hidden-xs">{{ fname }}</span>
                </a>
              </li>
              <!-- Sign Out  -->
              <li class="dropdown tasks-menu" title="Logout">
                <a href="{% url 'logout' %}" class="dropdown-toggle">
                  <i class="fa fa-power-off"></i>
                </a>
              </li>  
            </ul>
          </div>
        </nav>
      </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">
       {% include 'chatbot.html' %}
      </aside>

      <!-- Right side column. Contains the navbar and content of the page -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header">
          <h1>
            <small></small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="{% url 'client' %}"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="{% url 'client' %}">My Projects</a></li>
            <li href="{% url 'project_detail' project.project_id %}">{{ project.project_name }}</li>
            <li href="{% url 'tasks' project.project_id %}">Tasks</li>            
            <li class="active">Gantt Chart</li>
          </ol>
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
            <div class="col-md-12">
                              <div class="box-header with-border">
                  <h3 class="box-title">Gannt Chart</h3>
                  <div class="box-tools pull-right">
                    <button class="btn btn-default pull-right" style="background-color: #ff3300; color: black; font-weight: bold;"><a href="{% url 'client' %}" style="color: black;">Home</a></button>                    
                    <button class="btn btn-default pull-right" style="background-color: #ff3300; color: black; font-weight: bold;"><a href="{% url 'tasks' project.project_id %}" style="color: black;">Back</a></button>
                  </div><!-- /.box-tools -->
                </div><!-- /.box-header -->
              <div id="chart_div"></div>
            </div><!-- /.col -->
          </div><!-- /.row -->

        </section><!-- /.content -->
      </div><!-- /.content-wrapper -->
      <footer class="main-footer">
        <strong>Copyright <span id="year"></span>. <a href="">The Bengal Tigers üêÖ</a>.</strong>
      </footer>
    </div><!-- ./wrapper -->

    <!-- jQuery 2.1.3 -->
    <script src="{% static 'dashboard/plugins/jQuery/jQuery-2.1.3.min.js' %}"></script>
    <!-- jQuery UI 1.11.2 -->
    <script src="http://code.jquery.com/ui/1.11.2/jquery-ui.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.2 JS -->
    <script src="{% static 'dashboard/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script>    
    <!-- Morris.js charts -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="{% static 'dashboard/plugins/morris/morris.min.js' %}" type="text/javascript"></script>
    <!-- Sparkline -->
    <script src="{% static 'dashboard/plugins/sparkline/jquery.sparkline.min.js' %}" type="text/javascript"></script>
    <!-- jvectormap -->
    <script src="{% static 'dashboard/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'dashboard/plugins/jvectormap/jquery-jvectormap-world-mill-en.js' %}" type="text/javascript"></script>
    <!-- jQuery Knob Chart -->
    <script src="{% static 'dashboard/plugins/knob/jquery.knob.js' %}" type="text/javascript"></script>
    <!-- daterangepicker -->
    <script src="{% static 'dashboard/plugins/daterangepicker/daterangepicker.js' %}" type="text/javascript"></script>
    <!-- datepicker -->
    <script src="{% static 'dashboard/plugins/datepicker/bootstrap-datepicker.js' %}" type="text/javascript"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="{% static 'dashboard/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js' %}" type="text/javascript"></script>
    <!-- iCheck -->
    <script src="{% static 'dashboard/plugins/iCheck/icheck.min.js' %}" type="text/javascript"></script>
    <!-- Slimscroll -->
    <script src="{% static 'dashboard/plugins/slimScroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>
    <!-- FastClick -->
    <script src="{% static 'dashboard/plugins/fastclick/fastclick.min.js' %}"></script>
    <!-- Site Sync App -->
    <script src="{% static 'dashboard/dist/js/app.min.js' %}" type="text/javascript"></script>

    <!-- Site Sync for demo purposes -->
    <!-- <script src="{% static 'dashboard/dist/js/demo.js' %}" type="text/javascript"></script> -->

      <script type="text/javascript">
         new Date().getFullYear()
document.getElementById("year").innerHTML = new Date().getFullYear();
      </script>

      <script type="text/javascript">
        function cool() {
          alert("Hold on, we are making something cool! Kindly visit later ;)")
        }
      </script>
  </body>
</html>
