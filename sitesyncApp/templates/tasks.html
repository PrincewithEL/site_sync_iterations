<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Site Sync - {{ type }} Module - Tasks Details</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    {% load static %}
    {% load custom_filters %}
                {% load tz %} 
                  {% include 'chatbot.html' %}
    <!-- Bootstrap 3.3.2 -->
    <link href="{% static 'dashboard/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />   
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">   
    <!-- FontAwesome 4.3.0 -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" /> 
    <!-- Theme style -->
    <link href="{% static 'dashboard/dist/css/sitesync.css' %}" rel="stylesheet" type="text/css" />
    <!-- Skins -->
    <link href="{% static 'dashboard/dist/css/skins/skin-black.min.css' %}" rel="stylesheet" type="text/css" />
    <!-- bootstrap wysihtml5 - text editor -->
    <link href="{% static 'dashboard/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css' %}" rel="stylesheet" type="text/css" />
  </head>
      <style>
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        .dropdown:hover .dropbtn {
            background-color: orange;
        }
        
        .dropbtn {
            background-color: white;
            color: black;
            padding: 5px;
            font-size: 16px;
            border: none;
            cursor: pointer;
            width: 200px;
            text-align: left;
        }
        .custom-checkbox {
    display: block !important;
    margin: auto;
    width: 16px;
    height: 16px;
}
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.6.1/frappe-gantt.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/frappe-gantt/0.6.1/frappe-gantt.css" />
<script>
    $(document).ready(function() {
        var projectId = '{{ project.project_id }}';
        
        // Set gantt as a global variable
        window.gantt = null;

        function fetchDataAndDrawChart() {
            $.ajax({
                url: '/projects/' + projectId + '/tasks1/',
                method: 'GET',
                dataType: 'json',
                success: function(data) {
                    drawChart(data);
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error('Error fetching data:', textStatus, errorThrown);
                }
            });
        }

        function updateTaskDates(task, start, end) {
            {% if project.leader_id == auth_user.id %}
            $.ajax({
                url: '/projects/' + projectId + '/tasks/' + task.id + '/update-dates/',
                method: 'POST',
                contentType: 'application/json',
                data: JSON.stringify({
                    start_date: start.toISOString().split('T')[0],
                    due_date: end.toISOString().split('T')[0]
                }),
                headers: {
                    'X-CSRFToken': getCookie('csrftoken') // If using Django
                },
                success: function(response) {
                    console.log('Task dates updated successfully');
                    fetchDataAndDrawChart();
                },
                error: function(jqXHR, textStatus, errorThrown) {
                    console.error('Error updating task dates:', textStatus, errorThrown);
                    alert('Failed to update task dates. Please try again.');
                    fetchDataAndDrawChart();
                }
            });
            {% else %}
            fetchDataAndDrawChart();
            {% endif %}
        }

        // Helper function to get CSRF token (for Django)
        function getCookie(name) {
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }

function drawChart(data) {
    const tasks = data.tasks.map(task => ({
        id: task[0],
        name: task[1],
        start: new Date(task[3]),
        end: new Date(task[4]),
        progress: task[6],
        dependencies: task[7] || '',
        // Apply color based on the status or custom attribute
        custom_class: task[8] || (task[6] === 100 ? 'completed-task' : 'in-progress-task')
    }));

    // Initialize Frappe Gantt with customized bar classes
    window.gantt = new Gantt("#chart_div", tasks, {
        header_height: 50,
        column_width: 30,
        step: 24,
        view_modes: ['Quarter Day', 'Half Day', 'Day', 'Week', 'Month'],
        bar_height: 20,
        bar_corner_radius: 3,
        arrow_curve: 5,
        padding: 18,
        view_mode: 'Day',
        show_view_mode: true,
        date_format: 'YYYY-MM-DD',
        on_date_change: function(task, start, end) {
            updateTaskDates(task, start, end);
        },
        custom_popup_html: function(task) {
            return `
                <div class="details-container">
                    <h5>${task.name}</h5>
                    <p>Progress: ${task.progress}%</p>
                    <p>Start: ${task.start.toDateString()}</p>
                    <p>End: ${task.end.toDateString()}</p>
                    <p><small>Drag to adjust dates</small></p>
                </div>
            `;
        }
    });
}

        // Initial load
        fetchDataAndDrawChart();
    });

    // Define changeViewMode globally
    function changeViewMode(mode) {
        console.log("Changing view mode to:", mode); // Debug log
        if (window.gantt) {
            window.gantt.change_view_mode(mode);
            console.log("View mode changed to:", mode); // Debug log
        } else {
            console.error("Gantt chart not initialized.");
        }
    }
</script>
<style>
    .chart_div .bar.completed-task {
        fill: #4caf50; /* Green for completed tasks */
    }
    
    .chart_div .bar.in-progress-task {
        fill: #ff9800; /* Orange for in-progress tasks */
    }
    
    .chart_div .bar.custom-task {
        fill: #2196f3; /* Blue for a generic task */
    }

    /* Custom styling for the popup */
    .details-container {
        background-color: #f5f5f5;
        border-radius: 5px;
        padding: 10px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        font-family: Arial, sans-serif;
        color: #333;
    }

    /* Styling for Gantt chart header */
    .chart_div .header {
        background-color: #3f51b5;
        color: white;
    }
</style>

  <body class="skin-black">
    <div class="wrapper">
      
      <header class="main-header">
        <!-- Logo -->
        <a href="{% url 'client' %}" title="Site Sync" class="logo" style="color: orange;"><img src="{% static 'dashboard/dist/img/site_sync_logo.png' %}" style="width: 120px; position: relative; top: -8px;"></a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" role="navigation">
          <!-- Sidebar toggle button-->
<!--           <a href="#" title="Hide the Site Sync Assistant" class="sidebar-toggle" data-toggle="offcanvas" role="button">
            <span class="sr-only">Toggle navigation</span>
          </a> -->
          <div class="navbar-custom-menu">
              <ul class="nav navbar-nav">
  {% include 'notifications.html' %}
                <!-- User Account: style can be found in dropdown.less -->
              <li class="dropdown user user-menu" title="My Profile">
                <a href="{% url 'profile' %}" class="dropdown-toggle">
                  <img src="{{ MEDIA_URL }}{{ auth_user.profile.profile_picture }}" class="user-image" alt="User Image"/>
                  <span class="hidden-xs">{{ fname }}</span>
                </a>
              </li>
              <!-- Sign Out  -->
              <li class="dropdown tasks-menu" title="Logout">
                <a href="{% url 'logout' %}" class="dropdown-toggle">
                  <i class="fa fa-power-off"></i>
                </a>
              </li>  
            </ul>
          </div>
        </nav>
      </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">
      </aside>

      <!-- Right side column. Contains the navbar and content of the page -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header" style="position: relative; left: -950px;">
          <h1>
            <small></small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="{% url 'client' %}"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="{% url 'client' %}">My Projects</a></li>
            <li href="{% url 'project_detail' project.project_id %}">{{ project.project_name }}</li>
            <li class="active">Tasks</li>
          </ol>
        </section>


        <!-- Main content -->
        <section class="content">
          <div class="row">
            <div class="col-md-12">
              <div id="myTable">
              <div class="col-md-6">
              <div class="col-md-4">
              <a href="{% url 'client' %}"  onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;">Home <i class="fa fa-home"></i></i></a>
            </div>
            <div class="col-md-4">
              <a href="{% url 'project_detail' project.project_id %}"  onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;">Back <i class="fa fa-mail-reply"></i></a>
              </div> 
               {% if project.leader_id == auth_user.id %}
              <div class="col-md-4">
              <a href="#" onclick="openForm1();"  onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;">Add A Task <i class="fa fa-plus"></i></a>
            </div>
                {% endif %}
            <div class="col-md-12">
               <div class="box box-primary">
                <div class="box-header">
                  <i class="ion ion-clipboard"></i>
                  <h3 class="box-title">Overdue Project Tasks</h3>
                  {% if project.leader_id == auth_user.id %}
                  <h5>Overdue - ({{ overdue_tasks1 }})</h5>
                  {% endif %}
                  {% if project.leader_id != auth_user.id %}
                  <h5>Overdue - ({{ overdue_tasks }})</h5>
                  {% endif %}
                  <div class="box-tools pull-right">
                    <ul class="pagination pagination-sm inline">
                                    {% if project.leader_id == auth_user.id %}
    {% if o1tasks.has_previous %}
        <li>
            <a href="?page=1&filter={{ filter_type }}" class="{% if o1tasks.number == 1 %}disabled{% endif %}" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ o1tasks.previous_page_number }}&filter={{ filter_type }}" class="{% if not o1tasks.has_previous %}disabled{% endif %}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li> -->
    {% endif %}

    {% for page_num in o1tasks.paginator.page_range %}
        <li class="{% if o1tasks.number == page_num %}active{% endif %}">
            <a href="?page={{ page_num }}&filter={{ filter_type }}">{{ page_num }}</a>
        </li>
    {% endfor %}

    {% if o1tasks.has_next %}
        <li>
            <a href="?page={{ o1tasks.next_page_number }}&filter={{ filter_type }}" class="{% if not o1tasks.has_next %}disabled{% endif %}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ o1tasks.paginator.num_pages }}&filter={{ filter_type }}" class="{% if o1tasks.number == o1tasks.paginator.num_pages %}disabled{% endif %}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li> -->
        {% endif %}
        {% endif %}
                      {% if project.leader_id != auth_user.id %}
    {% if otasks.has_previous %}
        <li>
            <a href="?page=1&filter={{ filter_type }}" class="{% if otasks.number == 1 %}disabled{% endif %}" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ otasks.previous_page_number }}&filter={{ filter_type }}" class="{% if not otasks.has_previous %}disabled{% endif %}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li> -->
    {% endif %}

    {% for page_num in otasks.paginator.page_range %}
        <li class="{% if otasks.number == page_num %}active{% endif %}">
            <a href="?page={{ page_num }}&filter={{ filter_type }}">{{ page_num }}</a>
        </li>
    {% endfor %}

    {% if otasks.has_next %}
        <li>
            <a href="?page={{ otasks.next_page_number }}&filter={{ filter_type }}" class="{% if not otasks.has_next %}disabled{% endif %}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ otasks.paginator.num_pages }}&filter={{ filter_type }}" class="{% if otasks.number == otasks.paginator.num_pages %}disabled{% endif %}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li> -->                 
    {% endif %}
        {% endif %}
</ul>
                  </div>
                </div><!-- /.box-header -->
                <div class="box-body">
                  <ul class="todo-list">
                    {% if project.leader_id == auth_user.id %}
                    {% for task in o1tasks %}
                    <li>
                      <!-- drag handle -->
                      <!-- checkbox -->
                      <input type="checkbox" value="" name=""/>
                      <!-- todo text -->
            <span class="text">{{ task.task_name }} assigned to 
                {% for member in task.member.all %}
                    {{ member.first_name }} ({{ member.profile.user_type }}){% if not forloop.last %}, {% endif %}
                {% endfor %} - {{ task.task_details }}
            </span>
                      <!-- Emphasis label -->
                      {% if task.task_days_overdue != 0 %}
                      <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.task_days_left }} days left</small>
                      {% elif task.task_days_overdue == 0 %}
                      <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.task_days_left }} days left</small>
                      {% endif %}
                      <!-- General tools such as edit or delete-->
                      <div class="tools">
                        <a href="{% url 'delete_task' pk=task.project_id task_id=task.task_id %}" onclick="return confirm('Are You Sure You Want To Remove This Task ?')" class="btn btn-primary btn-xs pull-right"><i class="fa fa-trash-o"></i></a>
                      </div>
                    </li>
                    {% endfor %}
                    {% endif %}
                    {% if project.leader_id != auth_user.id %}
                    {% for task in otasks %}
                    <li>
                      <!-- drag handle -->
                      <!-- checkbox -->
                      <input type="checkbox" value="" name=""/>
                      <!-- todo text -->
                      <span class="text">{{ task.task_name }} - {{ task.task_details }}</span>
                      <!-- Emphasis label -->
                      {% if task.task_days_overdue != 0 %}
                      <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.task_days_left }} days left</small>
                      {% elif task.task_days_overdue == 0 %}
                      <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.task_days_left }} days left</small>
                      {% endif %}
                      <!-- General tools such as edit or delete-->
                      <div class="tools">
                        <a href="{% url 'complete_task' pk=task.project_id task_id=task.task_id %}" onclick="return confirm('Are You Sure You Want To Complete This Task ?')" class="btn btn-primary btn-xs pull-right"><i class="fa fa-check"></i></a>
                      </div>
                    </li>
                    {% endfor %}
                    {% endif %}
                  </ul>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
            </div>
            <div class="col-md-12">
                              <div class="box-header with-border">
                  <h3 class="box-title">Gantt Chart</h3>
                  <div class="box-tools pull-right">
                                <div class="">
              <a href="{% url 'gantt' project.project_id %}"  onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;"><i class="fa fa-expand"></i> Full View</a>
              <br>
              </div>
                  </div><!-- /.box-tools -->
                </div><!-- /.box-header -->
<div id="viewModeButtons">
                                <div class="col-md-4">
    <button class="btn btn-primary btn-block margin-bottom" onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;" onclick="changeViewMode('Day')">Daily</button>
</div>
<div class="col-md-4">
    <button class="btn btn-primary btn-block margin-bottom" onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;" onclick="changeViewMode('Week')">Weekly</button>
</div>
<div class="col-md-4">
    <button class="btn btn-primary btn-block margin-bottom" onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;" onclick="changeViewMode('Month')">Monthly</button>
</div>
</div>
<div class="col-md-12">
              <div id="chart_div"></div>
          </div>
            </div>
            </div>
            <div class="col-md-6">
                          <!-- TO DO List -->
              <div class="box box-primary">
                <div class="box-header">
                  <i class="ion ion-clipboard"></i>
                  <h3 class="box-title">Pending Project Tasks</h3>
                  {% if project.leader_id == auth_user.id %}
                  <h5>Pending - ({{ pending_tasks1 }})</h5>
                  {% endif %}
                  {% if project.leader_id != auth_user.id %}
                  <h5>Pending - ({{ pending_tasks }})</h5>
                  {% endif %}
                  <div class="box-tools pull-right">
                    <ul class="pagination pagination-sm inline">
                                    {% if project.leader_id == auth_user.id %}
    {% if p1tasks.has_previous %}
        <li>
            <a href="?page=1&filter={{ filter_type }}" class="{% if p1tasks.number == 1 %}disabled{% endif %}" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ p1tasks.previous_page_number }}&filter={{ filter_type }}" class="{% if not p1tasks.has_previous %}disabled{% endif %}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li> -->
    {% endif %}

    {% for page_num in p1tasks.paginator.page_range %}
        <li class="{% if p1tasks.number == page_num %}active{% endif %}">
            <a href="?page={{ page_num }}&filter={{ filter_type }}">{{ page_num }}</a>
        </li>
    {% endfor %}

    {% if p1tasks.has_next %}
        <li>
            <a href="?page={{ p1tasks.next_page_number }}&filter={{ filter_type }}" class="{% if not p1tasks.has_next %}disabled{% endif %}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ p1tasks.paginator.num_pages }}&filter={{ filter_type }}" class="{% if p1tasks.number == p1tasks.paginator.num_pages %}disabled{% endif %}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li> -->
        {% endif %}
        {% endif %}
                      {% if project.leader_id != auth_user.id %}
    {% if p1tasks.has_previous %}
        <li>
            <a href="?page=1&filter={{ filter_type }}" class="{% if p1tasks.number == 1 %}disabled{% endif %}" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ p1tasks.previous_page_number }}&filter={{ filter_type }}" class="{% if not p1tasks.has_previous %}disabled{% endif %}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li> -->
    {% endif %}

    {% for page_num in ptasks.paginator.page_range %}
        <li class="{% if ptasks.number == page_num %}active{% endif %}">
            <a href="?page={{ page_num }}&filter={{ filter_type }}">{{ page_num }}</a>
        </li>
    {% endfor %}

    {% if ptasks.has_next %}
        <li>
            <a href="?page={{ ptasks.next_page_number }}&filter={{ filter_type }}" class="{% if not ptasks.has_next %}disabled{% endif %}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ ptasks.paginator.num_pages }}&filter={{ filter_type }}" class="{% if ptasks.number == ptasks.paginator.num_pages %}disabled{% endif %}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li> -->                 
    {% endif %}
        {% endif %}
</ul>
                  </div>
                </div><!-- /.box-header -->
                <div class="box-body">
<ul class="todo-list">
    <!-- If the authenticated user is the project leader -->
    {% if project.leader_id == auth_user.id %}
        {% for task in p1tasks %}
<li title="Right Click Me To Edit...">
    <!-- Task View Mode (non-editable) -->
    <div class="task-view-mode">
        <span class="text">{{ task.task_name }} assigned to 
            {% for member in task.member.all %}
                {{ member.first_name }} ({{ member.profile.user_type }}){% if not forloop.last %}, {% endif %}
            {% endfor %} - {{ task.task_details }}
        </span>
        <span class="text">Due Date: {{ task.task_due_date }}</span>

        <!-- Days to complete or overdue -->
        {% if task.days_to_complete >= 0 %}
        <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.days_to_complete }} days left</small>
        {% else %}
        <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.days_overdue }} days overdue</small>
        {% endif %}
        
        <!-- Edit/Delete Tools -->
        <div class="tools">
            <a href="{% url 'delete_task' project.project_id task.task_id %}" 
               onclick="return confirm('Are You Sure You Want To Remove This Task?')" 
               class="btn btn-primary btn-xs pull-right">
                <i class="fa fa-trash-o"></i>
            </a>
        </div>
    </div>

    <!-- Task Edit Mode (editable inputs, initially hidden) -->
    <form id="task-{{ task.task_id }}" action="{% url 'update_task' task.task_id %}" method="post" class="task-edit-mode" style="display: none;">
        {% csrf_token %}
        
        <!-- Editable Task Name -->
        <input type="text" name="task_name" value="{{ task.task_name }}" class="form-control" />

        <!-- Editable Task Details -->
        <input type="text" name="task_details" value="{{ task.task_details }}" class="form-control" />

        <!-- Editable Due Date -->
        <input type="date" min="{{ day|date:'Y-m-d' }}" name="task_due_date" value="{{ task.task_due_date }}" class="form-control" />
        
        <!-- Save Button -->
        <button type="submit" class="btn btn-success btn-sm">Save</button>

        <!-- Exit Button -->
        <button type="button" class="btn btn-secondary btn-sm exit-edit-mode">Exit</button>
    </form>
</li>

        {% endfor %}
    {% endif %}

    <!-- If the authenticated user is NOT the project leader -->
    {% if project.leader_id != auth_user.id %}
        {% for task in ptasks %}
        <li>
            <!-- Task Name and Task Details -->
            <span class="text">{{ task.task_name }} - {{ task.task_details }}</span>
            <!-- Days to complete or overdue -->
            {% if task.days_to_complete >= 0 %}
            <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.days_to_complete }} days left</small>
            {% else %}
            <small class="label label-danger"><i class="fa fa-clock-o"></i> {{ task.days_overdue }} days overdue</small>
            {% endif %}
            <!-- Option to Complete Task -->
            <div class="tools">
                <a href="{% url 'complete_task' project.project_id task.task_id %}" 
                   onclick="return confirm('Are You Sure You Want To Complete This Task?')" 
                   class="btn btn-primary btn-xs pull-right">
                    <i class="fa fa-check"></i>
                </a>
            </div>
        </li>
        {% endfor %}
    {% endif %}
</ul>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
                            <div class="box box-primary">
                <div class="box-header">
                  <i class="ion ion-clipboard"></i>
                  <h3 class="box-title">Completed Project Tasks</h3>
                  {% if project.leader_id == auth_user.id %}
                  <h5>Completed - ({{ completed_tasks1 }})</h5>
                  {% endif %}
                  {% if project.leader_id != auth_user.id %}
                  <h5>Completed - ({{ completed_tasks }})</h5>
                  {% endif %}
                  <div class="box-tools pull-right">
                    <ul class="pagination pagination-sm inline">
                                    {% if project.leader_id == auth_user.id %}
    {% if c1tasks.has_previous %}
        <li>
            <a href="?page=1&filter={{ filter_type }}" class="{% if c1tasks.number == 1 %}disabled{% endif %}" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ c1tasks.previous_page_number }}&filter={{ filter_type }}" class="{% if not c1tasks.has_previous %}disabled{% endif %}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li> -->
    {% endif %}

    {% for page_num in c1tasks.paginator.page_range %}
        <li class="{% if c1tasks.number == page_num %}active{% endif %}">
            <a href="?page={{ page_num }}&filter={{ filter_type }}">{{ page_num }}</a>
        </li>
    {% endfor %}

    {% if c1tasks.has_next %}
        <li>
            <a href="?page={{ c1tasks.next_page_number }}&filter={{ filter_type }}" class="{% if not c1tasks.has_next %}disabled{% endif %}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ c1tasks.paginator.num_pages }}&filter={{ filter_type }}" class="{% if c1tasks.number == c1tasks.paginator.num_pages %}disabled{% endif %}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li> -->
        {% endif %}
        {% endif %}
                      {% if project.leader_id != auth_user.id %}
    {% if c1tasks.has_previous %}
        <li>
            <a href="?page=1&filter={{ filter_type }}" class="{% if c1tasks.number == 1 %}disabled{% endif %}" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ c1tasks.previous_page_number }}&filter={{ filter_type }}" class="{% if not c1tasks.has_previous %}disabled{% endif %}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
            </a>
        </li> -->
    {% endif %}

    {% for page_num in ctasks.paginator.page_range %}
        <li class="{% if ctasks.number == page_num %}active{% endif %}">
            <a href="?page={{ page_num }}&filter={{ filter_type }}">{{ page_num }}</a>
        </li>
    {% endfor %}

    {% if ctasks.has_next %}
        <li>
            <a href="?page={{ ctasks.next_page_number }}&filter={{ filter_type }}" class="{% if not ctasks.has_next %}disabled{% endif %}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li>
            <a href="?page={{ ctasks.paginator.num_pages }}&filter={{ filter_type }}" class="{% if ctasks.number == ctasks.paginator.num_pages %}disabled{% endif %}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li>
    {% else %}
<!--         <li class="disabled">
            <a href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
            </a>
        </li>
        <li class="disabled">
            <a href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
            </a>
        </li> -->                 
    {% endif %}
        {% endif %}
</ul>
                  </div>
                </div><!-- /.box-header -->
                <div class="box-body">
                  <ul class="todo-list">
                    {% if project.leader_id == auth_user.id %}
                    {% for task in c1tasks %}
                    <li>
                      <!-- drag handle -->
                      <!-- checkbox -->
                      <!-- <input type="checkbox" value="" name=""/> -->
                      <!-- todo text -->
            <span class="text">{{ task.task_name }} assigned to 
                {% for member_info in members_with_completed_tasks %}
                    {{ member_info.member.first_name }} ({{ member_info.member.user_type }}){% if not forloop.last %}, {% endif %}
                {% endfor %} - {{ task.task_details }}; {{ task.task_status }}.
            </span>
                      <!-- Emphasis label -->
                      <small class="label label-danger"><i class="fa fa-clock-o"></i> Completed At: {{ task.task_completed_date }}</small>
                    </li>
                    {% endfor %}
                    {% endif %}
                    {% if project.leader_id != auth_user.id %}
                    {% for task in ctasks %}
                    <li>
                      <!-- drag handle -->
                      <!-- checkbox -->
                      <!-- <input type="checkbox" value="" name=""/> -->
                      <!-- todo text -->
                      <span class="text">
                                        {% for member_info in members_with_completed_tasks %}
                    {{ member_info.member.first_name }} ({{ member_info.member.user_type }}){% if not forloop.last %}, {% endif %}
                {% endfor %} - {{ task.task_details }}; {{ task.task_status }}.
                      </span>
                      <!-- Emphasis label -->
                      <small class="label label-danger"><i class="fa fa-clock-o"></i> Completed At: {{ task.task_completed_date }}</small>
                    </li>
                    {% endfor %}
                    {% endif %}
                  </ul>
                </div><!-- /.box-body -->
              </div><!-- /.box -->
                            <!-- Calendar -->
<!--               <div class="box box-solid bg-green-gradient" style="background-color: #ff3300;">
                <div class="box-header">
                  <i class="fa fa-calendar"></i>
                  <h3 class="box-title">Calendar</h3>

                  <div class="pull-right box-tools">
                    <div class="btn-group">
                      <button class="btn btn-success btn-sm dropdown-toggle" data-toggle="dropdown"><i class="fa fa-bars"></i></button>
                      <ul class="dropdown-menu pull-right" role="menu">
                        <li><a href="#">Add new event</a></li>
                        <li><a href="#">Clear events</a></li>
                        <li class="divider"></li>
                        <li><a href="#">View calendar</a></li>
                      </ul>
                    </div>
                    <button class="btn btn-success btn-sm" data-widget="collapse"><i class="fa fa-minus"></i></button>
                    <button class="btn btn-success btn-sm" data-widget="remove"><i class="fa fa-times"></i></button>
                  </div>
                </div>
                <div class="box-body no-padding">
                  <div id="calendar" style="width: 100%"></div>
                </div>
              </div>-->
            </div>
                                      </div>
                                                    <div class="box box-primary" id="myForm">
                              <div class="box-header">
                                <h3 class="box-title">Add An Event</h3>
                                <button type="button" style="position: relative;" onclick="closeForm();" class="btn btn-primary"><i class="fa fa-window-close" style="font-size:12px"></i></button>
                              </div><!-- /.box-header -->
                              <!-- form start -->
<form action="{% url 'add_event' project.pk %}" method="POST">
    {% csrf_token %}
    <div class="box-body">
        <div class="form-group col-md-6">
            <label for="event_name">Event Name</label>
            <input type="text" class="form-control" id="event_name" name="event_name"placeholder="Event Name"  required>
        </div>
        <div class="form-group col-md-6">
            <label for="event_date">Event Date</label>
            <input type="date" min="{{ day }}" class="form-control" id="event_date" placeholder="Event Date"  name="event_date" required>
        </div>
        <div class="form-group col-md-6">
            <label for="event_start_time">Start Time</label>
            <input type="time" class="form-control" id="event_start_time"placeholder="Event Start Time"  name="event_start_time" required>
        </div>
        <div class="form-group col-md-6">
            <label for="event_end_time">End Time</label>
            <input type="time" class="form-control" id="event_end_time"placeholder="Event End Time"  name="event_end_time" required>
        </div>
        <div class="form-group">
            <label for="event_details">Event Details</label>
            <textarea class="form-control" rows="4" id="event_details"placeholder="Event Details..."  name="event_details" required placeholder="Enter Event Details..."></textarea>
        </div>
        <div class="form-group col-md-6">
            <label for="event_location">Event Location (optional)</label>
            <input type="text" class="form-control" id="event_location"placeholder="Event Location"  name="event_location">
        </div>
        <div class="form-group col-md-6">
            <label for="event_link">Event Link (optional)</label>
            <input type="url" class="form-control" id="event_link" placeholder="Event Link" name="event_link">
        </div>
    </div>
    <div class="box-footer">
        <button type="submit" class="btn btn-primary">Add Event</button>
        <button type="reset" class="btn btn-primary">Reset</button>
    </div>
</form>
                            </div><!-- /.box -->
{% if project.leader_id == auth_user.id %}
                                        <div class="box box-primary" id="myForm1">
                              <div class="box-header">
                                <h3 class="box-title">Add A Task</h3>
                                <button type="button" style="position: relative; right: -1090px;" onclick="closeForm1();" class="btn btn-primary"><i class="fa fa-window-close" style="font-size:12px"></i></button>
                              </div><!-- /.box-header -->
                              <!-- form start -->

<form action="{% url 'add_task' project.pk %}" method="POST">
    {% csrf_token %}
    <div class="box-body">
        <div class="form-group">
            <label for="task_name">Task Name</label>
            <input type="text" class="form-control" id="task_name" name="task_name" placeholder="Task Name" required>
        </div>
        <div class="form-group">
            <label for="task_details">Task Details</label>
            <textarea class="form-control" id="task_details" name="task_details" placeholder="Task Details" required></textarea>
        </div>
        <div class="form-group">
            <label for="transaction_price">Task Price</label>
            <input type="number" min="0" class="form-control" id="transaction_price" name="transaction_price" placeholder="Task Price" required>
        </div>
<div class="form-group">
  <label for="transaction_category">Transaction Category</label>
  <select required class="form-control" id="transaction_category" name="transaction_category">
    <option selected value="" disabled>Select A Transaction Category</option>
    <option value="Internal">Internal</option>
    <option value="External">External</option>
  </select>
</div>
<div class="form-group" id="transaction_type_group" style="display: none;">
  <label for="transaction_type">Transaction Type</label>
  <select required class="form-control" id="transaction_type" name="transaction_type">
    <option selected value="" disabled>Select A Transaction Type</option>
  </select>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const categorySelect = document.getElementById('transaction_category');
    const typeGroup = document.getElementById('transaction_type_group');
    const typeSelect = document.getElementById('transaction_type');

    function updateTransactionTypeOptions() {
        const selectedCategory = categorySelect.value;

        // Clear previous options
        typeSelect.innerHTML = '<option selected value="" disabled>Select A Transaction Type</option>';

        if (selectedCategory === 'Internal') {
            // Add options for Internal category
            const internalOptions = ['Salary', 'Bonus'];
            internalOptions.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                typeSelect.appendChild(opt);
            });
            typeGroup.style.display = 'block'; // Show the dropdown
        } else if (selectedCategory === 'External') {
            // Add options for External category
            const externalOptions = ['Materials', 'Transport', 'Machinery'];
            externalOptions.forEach(option => {
                const opt = document.createElement('option');
                opt.value = option;
                opt.textContent = option;
                typeSelect.appendChild(opt);
            });
            typeGroup.style.display = 'block'; // Show the dropdown
        } else {
            typeGroup.style.display = 'none'; // Hide the dropdown if no category is selected
        }
    }

    // Update options when the category changes
    categorySelect.addEventListener('change', updateTransactionTypeOptions);
});
</script>
        <!-- User Assignment Section -->
        <div id="user-assignments">
            <div class="form-group">
                <label for="members">Assign To</label>
                <select class="form-control" id="members" name="members[]" required>
                    <option value="" selected disabled>Select a User</option>
{% for member in project_members %}
    <option value="{{ member.id }}">
        {{ member.first_name }} ({{ member.user_type }})
    </option>
{% endfor %}
                </select>
            </div>
        </div>
        <button type="button" class="btn btn-secondary" onclick="addUserField()">Add Another User <i class="fa fa-plus"></i></button>

        <!-- Other fields remain the same -->
        <div class="form-group">
            <label for="due_date">Due Date</label>
            <input type="date" min="{{ project.start_date|date:'Y-m-d' }}" max="{{ project.end_date|date:'Y-m-d' }}" class="form-control" id="due_date" name="due_date" required>
        </div>
        <div class="form-group">
            <label for="dependent_task">Dependent Task (optional)</label>
            <select class="form-control" id="dependent_task" name="dependent_task">
                <option value="">Select a Dependent Task (if any)</option>
                {% for task in tasks %}
                    <option value="{{ task.task_id }}">{{ task.task_name }}</option>
                {% endfor %}
            </select>
        </div>
    </div>
    <div class="box-footer">
        <button type="submit" class="btn btn-primary">Add Task</button>
        <button type="reset" onclick="removeUserField();" class="btn btn-primary">Reset</button>
    </div>
</form>

<script>
    function addUserField() {
        const userSelectHtml = `
            <div class="form-group user-group">
                <label for="members">Assign To</label>
                <select class="form-control" name="members[]" required>
                    <option value="" selected disabled>Select a User</option>
                    {% for member in project_members %}
                        <option value="{{ member.id }}">{{ member.first_name }} ({{ member.user_type }})</option>
                    {% endfor %}
                </select>
                <button type="button" class="btn btn-danger remove-btn" onclick="removeUserField(this)">Remove<i class="fa fa-times"></i></button>
            </div>
        `;
        document.getElementById('user-assignments').insertAdjacentHTML('beforeend', userSelectHtml);
    }

    function removeUserField(button) {
        const userFieldGroup = button.parentElement; // Find the parent element containing the select and button
        userFieldGroup.remove(); // Remove the entire group
    }
</script>
</div><!-- /.box -->
{% endif %}                            

            </div><!-- /.col -->
          </div><!-- /.row -->

        </section><!-- /.content -->
      </div><!-- /.content-wrapper -->
      <footer class="main-footer">
        <strong>Copyright <span id="year"></span>. <a href="">The Bengal Tigers 🐅</a>.</strong>
      </footer>
    </div><!-- ./wrapper -->
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('li').forEach(function(taskItem) {
        taskItem.addEventListener('contextmenu', function(e) {
            e.preventDefault();  // Prevent default right-click menu
    
            // Hide the view mode
            let viewMode = this.querySelector('.task-view-mode');
            viewMode.style.display = 'none';
    
            // Show the edit mode
            let editMode = this.querySelector('.task-edit-mode');
            editMode.style.display = 'block';
        });

        // Handle the Exit button click
        let exitButton = taskItem.querySelector('.exit-edit-mode');
        if (exitButton) {
            exitButton.addEventListener('click', function() {
                // Show the view mode
                let viewMode = taskItem.querySelector('.task-view-mode');
                viewMode.style.display = 'block';
    
                // Hide the edit mode
                let editMode = taskItem.querySelector('.task-edit-mode');
                editMode.style.display = 'none';
            });
        }
    });
});


</script>
<script>
  document.getElementById("myForm").style.display = "none";
  document.getElementById("myForm1").style.display = "none";
function openForm() {
  document.getElementById("myForm").style.display = "block";
  document.getElementById("myTable").style.display = "none";
  document.getElementById("btnmyForm").style.display = "none";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
  document.getElementById("myTable").style.display = "block";
  document.getElementById("btnmyForm").style.display = "block";
}

function openForm1() {
  document.getElementById("myForm1").style.display = "block";
  document.getElementById("myTable").style.display = "none";
  document.getElementById("myForm").style.display = "none";
  document.getElementById("btnmyForm").style.display = "block";
  // document.getElementById("btnmyForm").style.display = "none";
}

function closeForm1() {
  document.getElementById("myForm1").style.display = "none";
  document.getElementById("myTable").style.display = "block";
  // document.getElementById("btnmyForm").style.display = "block";
}


function searchTable() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("events");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[0];
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = "";
      } else {
        tr[i].style.display = "none";
      }
    }       
  }
}
</script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var checkAllButton = document.querySelector('.checkbox-toggle');
    var projectCheckboxes = document.querySelectorAll('.events-checkbox');

    checkAllButton.addEventListener('click', function() {
        var isChecked = this.classList.toggle('checked');
        console.log(2);
        projectCheckboxes.forEach(function(checkbox) {
            checkbox.checked = isChecked;
        });

        this.innerHTML = isChecked ? '<i class="fa fa-check-square-o"></i>' : '<i class="fa fa-square-o"></i>';
    });
            function showAlert(type, message) {
            if (type === 'success') {
                alert('Success: ' + message);
            } else if (type === 'error') {
                alert('Error: ' + message);
            }
        }
        const successMessages = "{{ messages.success|safe }}";
        const errorMessages = "{{ messages.error|safe }}";
        if (successMessages) {
            successMessages.split(',').forEach(message => showAlert('success', message));
        }
        if (errorMessages) {
            errorMessages.split(',').forEach(message => showAlert('error', message));
        }
});
// Function to submit form
function submitForm(action) {
    document.getElementById('form-action').value = action;
    document.getElementById('events-action-form').submit();
}
</script>

    <!-- jQuery 2.1.3 -->
    <script src="{% static 'dashboard/plugins/jQuery/jQuery-2.1.3.min.js' %}"></script>
    <!-- jQuery UI 1.11.2 -->
    <script src="http://code.jquery.com/ui/1.11.2/jquery-ui.min.js" type="text/javascript"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.2 JS -->
    <script src="{% static 'dashboard/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script>    
    <!-- Morris.js charts -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="{% static 'dashboard/plugins/morris/morris.min.js' %}" type="text/javascript"></script>
    <!-- Sparkline -->
    <script src="{% static 'dashboard/plugins/sparkline/jquery.sparkline.min.js' %}" type="text/javascript"></script>
    <!-- jvectormap -->
    <script src="{% static 'dashboard/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'dashboard/plugins/jvectormap/jquery-jvectormap-world-mill-en.js' %}" type="text/javascript"></script>
    <!-- jQuery Knob Chart -->
    <script src="{% static 'dashboard/plugins/knob/jquery.knob.js' %}" type="text/javascript"></script>
    <!-- daterangepicker -->
    <script src="{% static 'dashboard/plugins/daterangepicker/daterangepicker.js' %}" type="text/javascript"></script>
    <!-- datepicker -->
    <script src="{% static 'dashboard/plugins/datepicker/bootstrap-datepicker.js' %}" type="text/javascript"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="{% static 'dashboard/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js' %}" type="text/javascript"></script>
    <!-- iCheck -->
    <script src="{% static 'dashboard/plugins/iCheck/icheck.min.js' %}" type="text/javascript"></script>
    <!-- Slimscroll -->
    <script src="{% static 'dashboard/plugins/slimScroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>
    <!-- FastClick -->
    <script src="{% static 'dashboard/plugins/fastclick/fastclick.min.js' %}"></script>
    <!-- Site Sync App -->
    <script src="{% static 'dashboard/dist/js/app.min.js' %}" type="text/javascript"></script>

    <!-- Site Sync for demo purposes -->
    <!-- <script src="{% static 'dashboard/dist/js/demo.js' %}" type="text/javascript"></script> -->

      <script type="text/javascript">
         new Date().getFullYear()
document.getElementById("year").innerHTML = new Date().getFullYear();
      </script>

      <script type="text/javascript">
        function cool() {
          alert("Hold on, we are making something cool! Kindly visit later ;)")
        }
                  $(document).ready(function() {
    $("body").addClass('sidebar-collapse'); // Add collapse class on page load
  });
      </script>

    <style>
        #chart_div {
            margin: 20px;
        }
        .details-container {
            padding: 10px;
            background: white;
            border-radius: 3px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .custom-task {
            fill: #a3a3ff;
        }
        /* Styles to indicate read-only state */
        .readonly-gantt .bar-wrapper {
            cursor: default !important;
        }
        .readonly-gantt .bar-wrapper .bar-progress {
            cursor: default !important;
        }
        .readonly-gantt .bar-wrapper .handle {
            display: none !important;
        }
        /* Remove hover effects */
        .readonly-gantt .bar-wrapper:hover .bar {
            fill: #a3a3ff !important;
        }
        .readonly-gantt .bar-wrapper:hover .bar-progress {
            fill: #8989ff !important;
        }
        .custom-task {
    background-color: #4caf50; /* Default color */
}

.custom-task.task-1 {
    background-color: #ff5733; /* Color for task 1 */
}

.custom-task.task-2 {
    background-color: #337ab7; /* Color for task 2 */
}
    </style>
  </body>
</html>
