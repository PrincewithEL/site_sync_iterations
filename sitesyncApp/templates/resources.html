<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Site Sync - {{ type }} Module - Files Page</title>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    {% load static %}
    {% load custom_filters %}
      {% include 'chatbot.html' %}
    <!-- Bootstrap 3.3.2 -->
    <link href="{% static 'dashboard/bootstrap/css/bootstrap.min.css' %}" rel="stylesheet" type="text/css" />   
    <link rel="icon" type="image/x-icon" href="{% static 'images/favicon.ico' %}">   
    <!-- FontAwesome 4.3.0 -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" type="text/css" /> 
    <!-- Theme style -->
    <link href="{% static 'dashboard/dist/css/sitesync.css' %}" rel="stylesheet" type="text/css" />
    <!-- Skins -->
    <link href="{% static 'dashboard/dist/css/skins/skin-black.min.css' %}" rel="stylesheet" type="text/css" />
    <!-- bootstrap wysihtml5 - text editor -->
    <link href="{% static 'dashboard/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.min.css' %}" rel="stylesheet" type="text/css" />
        <link rel="stylesheet" href="{% static 'dashboard/dist/plugins/iCheck/flat/blue.css' %}">
<script src="{% static 'dashboard/dist/plugins/iCheck/icheck.min.js' %}"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- Include necessary libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.10.2/viewer.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/viewerjs/1.10.2/viewer.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.9.359/pdf.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
  </head>
      <style>
        .dropdown {
            position: relative;
            display: inline-block;
        }
        
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 200px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
        }
        
        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }
        
        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }
        
        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        .dropdown:hover .dropbtn {
            background-color: orange;
        }
        
        .dropbtn {
            background-color: white;
            color: black;
            padding: 5px;
            font-size: 16px;
            border: none;
            cursor: pointer;
            width: 200px;
            text-align: left;
        }
        .custom-checkbox {
    display: block !important;
    margin: auto;
    width: 16px;
    height: 16px;
}
    </style>
  <body class="skin-black">
    <div class="wrapper">
      
      <header class="main-header">
        <!-- Logo -->
        <a href="{% url 'client' %}" class="logo" style="color: orange;"><img src="{% static 'dashboard/dist/img/site_sync_logo.png' %}" style="width: 120px; position: relative; top: -8px;"></a>
        <!-- Header Navbar: style can be found in header.less -->
        <nav class="navbar navbar-static-top" role="navigation">
          <!-- Sidebar toggle button-->
<!--           <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button" title="Toggle Site Sync Assistant">
            <span class="sr-only">Toggle navigation</span>
          </a> -->
          <div class="navbar-custom-menu">
                        <ul class="nav navbar-nav">
{% include 'notifications.html' %}
              <!-- User Account: style can be found in dropdown.less -->
              <li class="dropdown user user-menu" title="My Profile" >
                <a href="{% url 'profile' %}" class="dropdown-toggle">
                  <img src="{{ MEDIA_URL }}{{ auth_user.profile.profile_picture }}" class="user-image" alt="User Image"/>
                  <span class="hidden-xs">{{ fname }}</span>
                </a>
              </li>
              <!-- Sign Out  -->
              <li class="dropdown tasks-menu">
                <a href="{% url 'logout' %}" class="dropdown-toggle">
                  <i class="fa fa-power-off" title="Logout"></i>
                </a>
              </li> 
            </ul>
          </div>
        </nav>
      </header>
      <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">

      </aside>

      <!-- Right side column. Contains the navbar and content of the page -->
      <div class="content-wrapper">
        <!-- Content Header (Page header) -->
        <section class="content-header" style="position: relative; left: -690px;">
          <h1>
            <small></small>
          </h1>
          <ol class="breadcrumb">
            <li><a href="{% url 'client' %}"><i class="fa fa-dashboard"></i> Home</a></li>
            <li><a href="{% url 'client' %}">My Projects</a></li>
            <li><a href="{% url 'project_detail' project.pk %}">{{ project.project_name }}</a></li>
            <li class="active">My Files</li>
          </ol>
        </section>

        <!-- Main content -->
        <section class="content">
          <div class="row">
            <div class="col-md-3">
              <a href="{% url 'client' %}" onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;">Home <i class="fa fa-home"></i></a> 
              <a href="#" onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" onclick="openForm();" style="color: white; font-weight: bold;">Add A File <i class="fa fa-plus"></i></a>
              <a href="{% url 'project_detail' project.project_id %}" onMouseOver="this.style.color='black'" onMouseOut="this.style.color='white'" class="btn btn-primary btn-block margin-bottom" style="color: white; font-weight: bold;">Back <i class="fa fa-mail-reply"></i></a>                 
              <div class="box box-solid">
                <div class="box-header with-border">
                  <h3 class="box-title">List of Project Files</h3>
                </div>
                <div class="box-body no-padding">
                  <ul class="nav nav-pills nav-stacked">
                    <li class="active"><a href="?filter=all"><i class="fa fa-inbox"></i> All Files <span class="label label-primary pull-right">{{ resource_count }}</span></a></li>
                    <li class="{% if filter_type == 'Document' %}active{% endif %}"><a href="?filter=Document"><i class="fa fa-newspaper-o"></i> Document <span class="label label-waring pull-right">{{ document_count }}</span></a></li>
                    <li class="{% if filter_type == 'Video' %}active{% endif %}"><a href="?filter=Video"><i class="fa fa-file-video-o"></i> Videos <span class="label label-waring pull-right">{{ video_count }}</span></a></li>
                    <li class="{% if filter_type == 'Image' %}active{% endif %}"><a href="?filter=Image"><i class="fa fa-file-photo-o"></i> Photos <span class="label label-waring pull-right">{{ image_count }}</span></a></li>
                    <li class="{% if filter_type == 'Audio' %}active{% endif %}"><a href="?filter=Audio"><i class="fa fa-file-audio-o"></i> Audio <span class="label label-waring pull-right">{{ audio_count }}</span></a></li>
                    <li id="trashResourcesNavItem"><a href="#" onclick="opentrashResources();"><i class="fa fa-file-archive-o"></i> Trash <span class="label label-waring pull-right">{{ trash_resources_count }}</span></a></li>
                    <li class="{% if filter_type == 'bookmarked' %}active{% endif %}"><a href="?filter=bookmarked"><i class="fa fa-star"></i> Starred Files <span class="label label-waring pull-right">{{ bookmark_resources_count }}</span></a></li>
                  </ul>
                </div><!-- /.box-body -->
              </div><!-- /. box -->
<!--               <div class="box box-solid">
                <div class="box-header with-border">
                  <h3 class="box-title">Labels</h3>
                </div>
                <div class="box-body no-padding">
                  <ul class="nav nav-pills nav-stacked">
                    <li><a href="#"><i class="fa fa-circle-o text-red"></i> Important</a></li>
                    <li><a href="#"><i class="fa fa-circle-o text-yellow"></i> Promotions</a></li>
                    <li><a href="#"><i class="fa fa-circle-o text-light-blue"></i> Social</a></li>
                  </ul>
                </div> -->
                <!-- /.box-body -->
              <!-- </div> -->
              <!-- /.box -->
            </div><!-- /.col -->
            <div class="col-md-9">
              <div class="box box-primary" id="myTable">
                <div class="box-header with-border">
                  <h3 class="box-title">My Files</h3>
    {% if status_filter_display != 'All Files' or date_filter_display != 'All Time' %}    
    <div class="filter-info">
      <p><strong>Current Filters:</strong> {{ status_filter_display }} - {{ date_filter_display }}</p>
    </div>
    {% endif %}
    <div class="box-tools pull-right">
        <!-- New search form -->
        <form method="get" action="{% url 'resources' project.project_id %}" class="form-inline">
            <div class="input-group">
                <input type="text" class="form-control input-sm" name="search" placeholder="Search Resource(s)..." value="{{ request.GET.search }}">
                <span class="input-group-btn">
                    <button type="submit" class="btn btn-default btn-sm"><span class="glyphicon glyphicon-search"></span></button>
                </span>
            </div>
        </form>
    </div><!-- /.box-tools -->
                </div><!-- /.box-header -->
                <div class="box-body no-padding">
<form method="post" action="{% url 'delete_resources' pk=project.project_id %}" id="delete-form">
    {% csrf_token %}
    <input type="hidden" name="action" value="delete">
    <input type="hidden" name="selected_resource_ids" id="selected-resource-ids">
<div class="mailbox-controls">
    <!-- Check all button -->
<button type="button" class="btn btn-default btn-sm checkbox-toggle">
    <i class="fa fa-square-o"></i>
</button>

    <div class="btn-group">
    <button type="button" class="btn btn-default btn-sm" onclick="confirmAndSubmit();">
        <i class="fa fa-trash-o"></i> Delete
    </button>
</form>
<button type="button" class="btn btn-default btn-sm" onclick="if(confirm('Are You Sure You Want To Star This Resource(s) ?')) { submitForm('bookmark'); }">
    <i class="fa fa-star"></i> Star
</button>
<button type="button" class="btn btn-default btn-sm" onclick="if(confirm('Are You Sure You Want To Not Star This Resource(s) ?')) { submitForm('unbookmark'); }">
    <i class="fa fa-star-o"></i> Not Star
</button>
</div>
      <div class="btn-group">
      <div class="filter-options">
        <form method="get" action="{% url 'resources' project.project_id %}" class="form-inline">
          <div class="form-group">
            <label for="date_filter" class="sr-only">Date Filter:</label>
            <select name="date_filter" id="date_filter" class="form-control input-sm">
              <option value="" {% if not current_date_filter %}selected{% endif %}>All Time</option>
              <option value="today" {% if current_date_filter == 'today' %}selected{% endif %}>Today</option>
              <option value="this_week" {% if current_date_filter == 'this_week' %}selected{% endif %}>This Week</option>
              <option value="this_month" {% if current_date_filter == 'this_month' %}selected{% endif %}>This Month</option>
              <option value="this_year" {% if current_date_filter == 'this_year' %}selected{% endif %}>This Year</option>
            </select>
          </div>
          <div class="form-group">
            <label for="filter" class="sr-only">Status Filter:</label>
            <select name="filter" id="filter" class="form-control input-sm">
              <option value="all" {% if current_status_filter == 'all' %}selected{% endif %}>All Files</option>
              <option value="audio" {% if current_status_filter == 'audio' %}selected{% endif %}>Audio</option>
              <option value="document" {% if current_status_filter == 'documents' %}selected{% endif %}>Documents</option>
              <option value="image" {% if current_status_filter == 'image' %}selected{% endif %}>Photos</option>
              <option value="video" {% if current_status_filter == 'video' %}selected{% endif %}>Video</option>              
            </select>
          </div>
          <button type="submit" class="btn btn-primary btn-sm">Apply Filters</button>
        </form>
      </div>
    </div><!-- /.btn-group -->
<div class="pull-right">
    Page {{ resources.number }} of {{ resources.paginator.num_pages }}
    <div class="btn-group">
      {% if resources.has_previous %}
        <a href="?page=1&filter={{ filter_type }}" class="btn btn-default btn-sm {% if resources.number == 1 %}disabled{% endif %}">
            <i class="fa fa-chevron-left"></i><i class="fa fa-chevron-left"></i> First
        </a>
        <a href="?page={% if resources.has_previous %}{{ resources.previous_page_number }}{% else %}1{% endif %}&filter={{ filter_type }}" class="btn btn-default btn-sm {% if not resources.has_previous %}disabled{% endif %}">
            <i class="fa fa-chevron-left"></i> Previous
        </a>
        {% endif %}
        {% if resources.has_next %}
        <a href="?page={% if resources.has_next %}{{ resources.next_page_number }}{% else %}{{ resources.paginator.num_pages }}{% endif %}&filter={{ filter_type }}" class="btn btn-default btn-sm {% if not resources.has_next %}disabled{% endif %}">
            <i class="fa fa-chevron-right"></i> Next
        </a>
        <a href="?page={{ resources.paginator.num_pages }}&filter={{ filter_type }}" class="btn btn-default btn-sm {% if resources.number == resources.paginator.num_pages %}disabled{% endif %}">
            <i class="fa fa-chevron-right"></i><i class="fa fa-chevron-right"></i> Last
        </a>
        {% endif %}
    </div><!-- /.btn-group -->
</div><!-- /.pull-right -->
</div><!-- /.mailbox-controls -->
<form method="post" id="resources-action-form" onsubmit="">
    {% csrf_token %}
    <input type="hidden" name="action" id="form-action" value="">
                <div class="box-footer">
        <ul class="mailbox-attachments clearfix" id="resources">
            {% for resource in resources %}
            <li>
<!-- HTML Template -->
<div class="file-preview-container">
    <div class="file-preview-item" data-file-url="{{ MEDIA_URL }}{{ resource.resource_directory }}" data-file-type="{{ resource.resource_type }}">
      {% if resource.resource_type == 'Video' %}
        <video width="100" height="100" preload="metadata">
          <source src="{{ MEDIA_URL }}{{ resource.resource_directory }}" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      {% elif resource.resource_type == 'Audio' %}
        <audio controls>
          <source src="{{ MEDIA_URL }}{{ resource.resource_directory }}" type="audio/mpeg">
          Your browser does not support the audio element.
        </audio>
      {% elif resource.resource_type == 'Image' %}
        <img src="{{ MEDIA_URL }}{{ resource.resource_directory }}" alt="{{ resource.resource_name }}" style="width: 100px; height: 100px; object-fit: cover;" />
      {% elif resource.resource_type == 'Document' %}
        <div class="document-preview" style="width: 100px; height: 100px; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center;">
          <i class="fa fa-file-o"></i>
        </div>
      {% else %}
        <div class="file-icon" style="width: 100px; height: 100px; background-color: #f0f0f0; display: flex; align-items: center; justify-content: center;">
          <i class="fa fa-file-o"></i>
        </div>
      {% endif %}
      <p>{{ resource.resource_name }}</p>
    </div>
</div>

<!-- Modal for file preview -->
<div id="filePreviewModal" class="modal">
  <div class="modal-content">
    <span class="close">&times;</span>
    <div id="filePreviewContent"></div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const fileItems = document.querySelectorAll('.file-preview-item');
  const modal = document.getElementById('filePreviewModal');
  const modalContent = document.getElementById('filePreviewContent');
  const closeBtn = document.querySelector('.close');

  fileItems.forEach(item => {
    item.addEventListener('click', function() {
      const fileUrl = this.dataset.fileUrl;
      const fileType = this.dataset.fileType;

      modalContent.innerHTML = '';  // Clear previous content

      if (fileType === 'Image') {
        const img = document.createElement('img');
        img.src = fileUrl;
        modalContent.appendChild(img);
        new Viewer(img);
      } else if (fileType === 'Video') {
        const video = document.createElement('video');
        video.src = fileUrl;
        video.controls = true;
        video.style.maxWidth = '100%';
        modalContent.appendChild(video);
      } else if (fileType === 'Audio') {
        const audio = document.createElement('audio');
        audio.src = fileUrl;
        audio.controls = true;
        modalContent.appendChild(audio);
      } else if (fileType === 'Document') {
    if (fileUrl.endsWith('.pdf')) {
        const iframe = document.createElement('iframe');
        iframe.src = `/static/pdfjs/web/viewer.html?file=${encodeURIComponent(fileUrl)}`;
        iframe.style.width = '100%';
        iframe.style.height = '600px';
        modalContent.appendChild(iframe);
    } else if (fileUrl.endsWith('.doc') || fileUrl.endsWith('.docx') || fileUrl.endsWith('.ppt') || fileUrl.endsWith('.xls')) {
        const iframe = document.createElement('iframe');
        iframe.src = `https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(fileUrl)}`;
        iframe.style.width = '100%';
        iframe.style.height = '600px';
        modalContent.appendChild(iframe);
    } else {
        modalContent.innerHTML = '<p>Preview not available for this file type.</p>';
    }
} else {
        modalContent.innerHTML = '<p>Preview not available for this file type.</p>';
      }

      modal.style.display = 'block';
    });
  });

  closeBtn.onclick = function() {
    modal.style.display = 'none';
  }

  window.onclick = function(event) {
    if (event.target == modal) {
      modal.style.display = 'none';
    }
  }
});
</script>

<style>
.modal {
  display: none;
  position: fixed;
  z-index: 1;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  overflow: auto;
  background-color: rgba(0,0,0,0.4);
}

.modal-content {
  background-color: #fefefe;
  margin: 15% auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

.close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}
</style>
                <div class="mailbox-attachment-info">
    <input type="checkbox" id="resource-{{ resource.resource_id }}" name="selected_resources" value="{{ resource.resource_id }}" class="resources-checkbox">
    <label for="resource-{{ resource.resource_id }}"></label>
                    <a href="#" class="mailbox-attachment-name">{{ resource.resource_name }}</a>
                        <form method="post" action="{% url 'resources' pk=project.project_id %}">
                          {% csrf_token %}
        <button type="submit" class="btn btn-link" style="padding: 0; border: none; background: none;"
        onclick="return confirm('Are You Sure You Want To {% if resource.resource_id in bookmarked_resources_ids %}Remove The Star For{% else %}Star{% endif %} This Resource?')">
        <input type="hidden" id="inputs" name="selected_resource" value="{{ resource.resource_id }}">
        <input type="hidden" name="action1" value="{% if resource.resource_id in bookmarked_resources_ids %}unbookmark1{% else %}bookmark1{% endif %}">
        <i class="fa {% if resource.resource_id in bookmarked_resources_ids %}fa-star{% else %}fa-star-o{% endif %} text-yellow"></i>
    </button>
  </form>
                    <span class="mailbox-attachment-size">
                        {{ resource.resource_size }}<br>
                        {{ resource.resource_details }}
                        <a href="{{MEDIA_URL}}{{ resource.resource_directory }}" class="btn btn-default btn-xs pull-right" download><i class="fa fa-cloud-download"></i></a>
                        <a href="{% url 'delete_resource' pk=resource.project_id resource_id=resource.resource_id %}" onclick="return confirm('Are You Sure You Want To Remove This Resource ?')" class="btn btn-default btn-xs pull-right"><i class="fa fa-trash-o"></i></a>
                    </span>
                </div>
            </li>
            {% endfor %}
        </ul>
                </div><!-- /.box-footer -->
              </form>
                </div><!-- /.box-body -->
              </div><!-- /. box -->

              <div class="box box-primary" id="myForm1">
                <div class="box-header with-border">
                  <h3 class="box-title">My Trash Files</h3>
                  <button type="button" style="position: relative; right: -500px;" onclick="closetrashResources();" class="btn btn-primary"><i class="fa fa-window-close" style="font-size:12px"></i></button>
                  <div class="box-tools pull-right">
                    <div class="has-feedback">
                      <input type="text" class="form-control input-sm" id="myInput" onkeyup="searchTable();"  placeholder="Search My Files..."/>
                      <span class="glyphicon glyphicon-search form-control-feedback"></span>
                    </div>
                  </div><!-- /.box-tools -->
                </div><!-- /.box-header -->
                                <div class="mailbox-controls">
<!--     <div class="btn-group">
<button type="button" class="btn btn-default btn-sm" onclick="if(confirm('Are You Sure You Want To Restore This Resource(s) ?')) { submitForm('restore'); }">
    <i class="fa fa-save"></i> Restore
</button>
<button type="button" class="btn btn-default btn-sm" onclick="if(confirm('Are You Sure You Want To Permanently Delete This Resource(s) ?')) { submitForm('delete1'); }">
    <i class="fa fa-trash-o"></i> Delete
</button>
    </div> -->
    <!-- /.btn-group -->
</div><!-- /.mailbox-controls -->
                <div class="box-body no-padding">
                  <div class="table-responsive mailbox-messages">
                    <table class="table table-hover table-striped" id="resources1">
                      <thead>
                        <!-- <th></th> -->
                        <th>Name</th>
                        <th>File</th>
                        <th>Resource Details</th>
                        <th>Resource Type</th>
                        <th>Days Until Permanent Deletion</th>
                        <th></th>
                        <th></th>
                      </thead>
                      <tbody>
{% for trash_resource in trash_resources %}
{% if trash_resource.days_until_permanent_deletion > 0 %}
    <tr title="{{ trash_resource.deleted_at }}">
        <td class="mailbox-name">{{ trash_resource.resource_name }}</td>
        <td class="mailbox-name">
{% if trash_resource.resource_type == 'Video' %}
    <i class="fa fa-file-video-o"></i>
{% elif trash_resource.resource_type == 'Audio' %}
    <i class="fa fa-file-audio-o"></i>
{% elif trash_resource.resource_type == 'Image' %}
    <img src="{{ MEDIA_URL }}{{ resource.resource_directory }}" alt="Attachment" style="width: 100px; height: 100px;" />
{% elif trash_resource.resource_type == 'Document' %}
    {% if trash_resource.resource_name|file_extension:'.pdf' %}
        <i class="fa fa-file-pdf-o"></i>
    {% elif trash_resource.resource_name|file_extension:'.doc' or trash_resource.resource_name|file_extension:'.docx' %}
        <i class="fa fa-file-word-o"></i>
    {% elif trash_resource.resource_name|file_extension:'.xls' or trash_resource.resource_name|file_extension:'.xlsx' %}
        <i class="fa fa-file-excel-o"></i>
    {% elif trash_resource.resource_name|file_extension:'.ppt' or trash_resource.resource_name|file_extension:'.pptx' %}
        <i class="fa fa-file-powerpoint-o"></i>
    {% elif trash_resource.resource_name|file_extension:'.txt' %}
        <i class="fa fa-file-text-o"></i>
    {% elif trash_resource.resource_name|file_extension:'.zip' or trash_resource.resource_name|file_extension:'.rar' %}
        <i class="fa fa-file-archive-o"></i>
    {% else %}
        <i class="fa fa-file-o"></i>
    {% endif %}
{% else %}
    <i class="fa fa-file-o"></i>
{% endif %}
        </td>        
        <td class="mailbox-name">{{ trash_resource.resource_details }}</td>
        <td class="mailbox-name">{{ trash_resource.resource_type }}</td>
        <td class="mailbox-name">{{ trash_resource.days_until_permanent_deletion }}</td>                
                            <td class="mailbox-attachment">
                            <form method="POST" name="update_project_member_form" action="{% url 'restore_resource' pk=trash_resource.project_id  resource_id=trash_resource.resource_id %}" enctype="multipart/form-data">
                              {% csrf_token %}
                              <button type="submit" class="btn btn-primary" onclick="return confirm('Are You Sure You Want To Restore This Resource ?')">Restore</button>
                            </form>
                        </td>
                                                  <td class="mailbox-attachment">
                            <form method="POST" name="update_project_member_form" action="{% url 'hide_resource' pk=trash_resource.project_id resource_id=trash_resource.resource_id %}" enctype="multipart/form-data">
                              {% csrf_token %}
                              <button type="submit" class="btn btn-primary" onclick="return confirm('Are You Sure You Want To Permanently Remove This Resource ?')">Remove</button>
                            </form>
                        </td>
    </tr>
{% endif %}
{% endfor %}
                      </tbody>
                    </table><!-- /.table -->
                  </div><!-- /.mail-box-messages -->
                </div><!-- /.box-body -->
              </div><!-- /. box -->

              <div class="box box-primary" id="myForm">
                <div class="box-header">
                  <h3 class="box-title">Add A Files</h3>
                  <button type="button" style="position: relative; right: -750px;" onclick="closeForm();" class="btn btn-primary"><i class="fa fa-window-close" style="font-size:12px"></i></button>
                </div><!-- /.box-header -->
                <!-- form start -->
<form action="{% url 'add_resource' project.pk %}" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <div class="box-body">
      <div class="form-group col-md-12">
        <label for="resource_name">Files Name</label>
        <input type="text" class="form-control" id="resource_name" name="resource_name" required>
      </div>
            <div class="form-group col-md-6" style="display: none;">
        <label for="resource_type">Files Type</label>
        <select class="form-control" id="resource_type" name="resource_type" required>
          <option value="" selected>Kindly Select A Resource Type</option>
          <option value="Image">Image</option>
          <option value="Video">Video</option>
          <option value="Audio">Audio</option>
          <option value="Document">Document</option>
        </select>
      </div>
      <div class="form-group">
        <label for="resource_details">Files Details</label>
        <textarea class="form-control" id="resource_details" name="resource_details" required></textarea>
      </div>
      <div class="form-group">
        <label for="resource_file">File</label>
        <input type="file" id="resource_file" name="resource_file" accept=".pdf, .doc, .docx, .ppt, .zip, .png, .jpeg, .mp4, .wav, .mp3, .m4a, .mov" required>
        <div id="file_preview" style="margin-top: 10px;"></div>
      </div>
    </div>
    <div class="box-footer">
      <button type="submit" class="btn btn-primary">Submit</button>
      <button type="reset" class="btn btn-primary">Reset</button>
    </div>
  </form>
              </div><!-- /.box -->

            </div><!-- /.col -->
          </div><!-- /.row -->

        </section><!-- /.content -->
      </div><!-- /.content-wrapper -->
      <footer class="main-footer">
        <strong>Copyright <span id="year"></span>. <a href="">The Bengal Tigers 🐅</a>.</strong>
      </footer>
    </div><!-- ./wrapper -->

<script>
  document.getElementById("myForm").style.display = "none";
  document.getElementById("myForm1").style.display = "none";  
function openForm() {
  document.getElementById("myForm").style.display = "block";
  document.getElementById("myTable").style.display = "none";
  document.getElementById("myForm1").style.display = "none";
}

function closeForm() {
  document.getElementById("myForm").style.display = "none";
  document.getElementById("myTable").style.display = "block";
  document.getElementById("myForm1").style.display = "none";
  document.getElementById("btnmyForm").style.display = "block";
}

function opentrashResources() {
  document.getElementById("myForm1").style.display = "block";
  document.getElementById("myTable").style.display = "none";
  document.getElementById('allProjNavItem').classList.remove('active');
  document.getElementById('trashResourcesNavItem').classList.add('active');
}

function closetrashResources() {
  document.getElementById("myForm1").style.display = "none";
  document.getElementById("myTable").style.display = "block";
  document.getElementById('allProjNavItem').classList.add('active');
  document.getElementById('trashResourcesNavItem').classList.remove('active');
}

function allProj() {
  document.getElementById("myForm1").style.display = "none";
  document.getElementById("myForm").style.display = "none";
  document.getElementById("myTable").style.display = "block";
  document.getElementById('allProjNavItem').classList.add('active');
  document.getElementById('trashResourcesNavItem').classList.remove('active');
}

function searchList() {
  var input, filter, ul, li, a, i, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  ul = document.getElementById("resources");
  li = ul.getElementsByTagName("li");
  for (i = 0; i < li.length; i++) {
    a = li[i].getElementsByClassName("mailbox-attachment-name")[0];
    if (a) {
      txtValue = a.textContent || a.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        li[i].style.display = "";
      } else {
        li[i].style.display = "none";
      }
    }       
  }
}

function searchTable() {
  var input, filter, table, tr, tdName, tdDetails, i, txtValueName, txtValueDetails;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase();
  table = document.getElementById("resources1");
  tr = table.getElementsByTagName("tr");

  // Start loop from 1 to skip the header row (assuming the first row is the header)
  for (i = 1; i < tr.length; i++) {
    tr[i].style.display = "none"; // Initially hide the row
    
    // Get the "Name" and "Resource Details" columns (assuming 1st and 2nd columns)
    tdName = tr[i].getElementsByTagName("td")[0]; 
    tdDetails = tr[i].getElementsByTagName("td")[1];

    if (tdName || tdDetails) {
      txtValueName = tdName ? tdName.textContent || tdName.innerText : "";
      txtValueDetails = tdDetails ? tdDetails.textContent || tdDetails.innerText : "";

      if (txtValueName.toUpperCase().indexOf(filter) > -1 || txtValueDetails.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = ""; 
      }
    }
  }
}


</script>
      <script type="text/javascript">
        function cool() {
          alert("Hold on, we are making something cool! Kindly visit later ;)")
        }
      </script>

<script>
    document.getElementById("resource_file").addEventListener("change", function() {
        var fileInput = document.getElementById("resource_file");
        var resourceTypeSelect = document.getElementById("resource_type");
        var fileName = fileInput.value.split('.').pop().toLowerCase();
        var resourceType = "";

        switch (fileName) {
            case 'png':
            case 'jpeg':
            case 'jpg':
                resourceType = "Image";
                break;
            case 'mp4':
            case 'mov':
                resourceType = "Video";
                break;
            case 'mp3':
            case 'wav':
            case 'm4a':
                resourceType = "Audio";
                break;
            case 'pdf':
            case 'doc':
            case 'docx':
            case 'ppt':
            case 'zip':
            case 'rar':
                resourceType = "Document";
                break;
            default:
                resourceType = "";
        }

        // Set the value of the resource_type select element
        for (var i = 0; i < resourceTypeSelect.options.length; i++) {
            if (resourceTypeSelect.options[i].value === resourceType) {
                resourceTypeSelect.selectedIndex = i;
                break;
            }
        }
    });

    // Prevent form submission if resource_type is not valid
    document.querySelector("form").addEventListener("submit", function(event) {
        var resourceTypeSelect = document.getElementById("resource_type");
        if (resourceTypeSelect.value === "") {
            event.preventDefault(); // Prevent form submission
            resourceTypeSelect.focus(); // Focus on the select element
            alert("Please select a valid resource type.");
        }
    });
</script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    var checkAllButton = document.querySelector('.checkbox-toggle');
    var projectCheckboxes = document.querySelectorAll('.resources-checkbox');

    checkAllButton.addEventListener('click', function() {
        var isChecked = this.classList.toggle('checked');
        console.log(2);
        projectCheckboxes.forEach(function(checkbox) {
            checkbox.checked = isChecked;
        });

        this.innerHTML = isChecked ? '<i class="fa fa-check-square-o"></i>' : '<i class="fa fa-square-o"></i>';
    });
            function showAlert(type, message) {
            if (type === 'success') {
                alert('Success: ' + message);
            } else if (type === 'error') {
                alert('Error: ' + message);
            }
        }
        const successMessages = "{{ messages.success|safe }}";
        const errorMessages = "{{ messages.error|safe }}";
        if (successMessages) {
            successMessages.split(',').forEach(message => showAlert('success', message));
        }
        if (errorMessages) {
            errorMessages.split(',').forEach(message => showAlert('error', message));
        }
});
// Function to submit form
function submitForm(action) {
    document.getElementById('form-action').value = action;
    document.getElementById('resources-action-form').submit();
    document.getElementById('inputs').value = 0;    
}
function submitForm1(action) {
    document.getElementById('form-action').value = action;
    document.getElementById('resources-action-form').submit();
    document.getElementById('inputs').value = 0;    
}
</script>
<script>
    function confirmAndSubmit() {
        var selectedIds = [];
        document.querySelectorAll('.resources-checkbox:checked').forEach(function(checkbox) {
            selectedIds.push(checkbox.value);
        });

        if (selectedIds.length === 0) {
            alert('No resources selected for deletion.');
            return false;
        }

        // Set the selected resource IDs in the hidden input field
        document.getElementById('selected-resource-ids').value = JSON.stringify(selectedIds);

        // Confirm and submit the form
        if (confirm('Are You Sure You Want To Delete This Resource(s)?')) {
            document.getElementById('delete-form').submit();
        }
    }
</script>
    <!-- jQuery 2.1.3 -->
    <script src="{% static 'dashboard/plugins/jQuery/jQuery-2.1.3.min.js' %}"></script>
    <!-- jQuery UI 1.11.2 -->
    <script src="http://code.jquery.com/ui/1.11.2/jquery-ui.min.js" type="text/javascript"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
      $.widget.bridge('uibutton', $.ui.button);
    </script>
    <!-- Bootstrap 3.3.2 JS -->
    <script src="{% static 'dashboard/bootstrap/js/bootstrap.min.js' %}" type="text/javascript"></script> 
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>   
    <!-- Morris.js charts -->
    <script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.0/raphael-min.js"></script>
    <script src="{% static 'dashboard/plugins/morris/morris.min.js' %}" type="text/javascript"></script>
    <!-- Sparkline -->
    <script src="{% static 'dashboard/plugins/sparkline/jquery.sparkline.min.js' %}" type="text/javascript"></script>
    <!-- jvectormap -->
    <script src="{% static 'dashboard/plugins/jvectormap/jquery-jvectormap-1.2.2.min.js' %}" type="text/javascript"></script>
    <script src="{% static 'dashboard/plugins/jvectormap/jquery-jvectormap-world-mill-en.js' %}" type="text/javascript"></script>
    <!-- jQuery Knob Chart -->
    <script src="{% static 'dashboard/plugins/knob/jquery.knob.js' %}" type="text/javascript"></script>
    <!-- daterangepicker -->
    <script src="{% static 'dashboard/plugins/daterangepicker/daterangepicker.js' %}" type="text/javascript"></script>
    <!-- datepicker -->
    <script src="{% static 'dashboard/plugins/datepicker/bootstrap-datepicker.js' %}" type="text/javascript"></script>
    <!-- Bootstrap WYSIHTML5 -->
    <script src="{% static 'dashboard/plugins/bootstrap-wysihtml5/bootstrap3-wysihtml5.all.min.js' %}" type="text/javascript"></script>
    <!-- iCheck -->
    <script src="{% static 'dashboard/plugins/iCheck/icheck.min.js' %}" type="text/javascript"></script>
    <!-- Slimscroll -->
    <script src="{% static 'dashboard/plugins/slimScroll/jquery.slimscroll.min.js' %}" type="text/javascript"></script>
    <!-- FastClick -->
    <script src="{% static 'dashboard/plugins/fastclick/fastclick.min.js' %}"></script>
    <!-- Site Sync App -->
    <script src="{% static 'dashboard/dist/js/app.min.js' %}" type="text/javascript"></script>
    <!-- Site Sync for demo purposes -->
    <!-- <script src="{% static 'dashboard/dist/js/demo.js' %}" type="text/javascript"></script> -->

      <script type="text/javascript">
         new Date().getFullYear()
document.getElementById("year").innerHTML = new Date().getFullYear();
          $(document).ready(function() {
    $("body").addClass('sidebar-collapse'); // Add collapse class on page load
  });
      </script>
  </body>
</html>
